<!DOCTYPE html>
<html>

<head>
    <title>Urlaubsantragsverwaltung</title>
    <!-- Verknüpfung zu Bootstrap-CSS hinzufügen -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body>
    <div class="container">
        <h1 class="mt-4">Anträge prüfen</h1>
        <p>Willkommen zur Antragsübersicht Ihrer Mitarbeiter.</p>

        <!-- Display request list -->
        <div id="requestList"></div>

    <!-- Verknüpfung zu Bootstrap-JavaScript hinzufügen (optional) -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', async function () {
            try {
                var user_id;
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    // Check if this is the cookie we're looking for
                    if (cookie.startsWith('user_id' + '=')) {
                        user_id = cookie.split('user_id=')[1];
                    }
                }
                // Get employees vacation_requests
                const response = await fetch(`/get-vacation-requests/${user_id}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                const data = await response.json();

                if (response.ok) {
                    // Display the data in table -> rows with buttons for accepting and denying request
                    const requestListDiv = document.getElementById('requestList');
                    requestListDiv.innerHTML = '<h2>Request List</h2>';

                    data.forEach(request => {
                        requestListDiv.innerHTML += `<p>${request.request_id} - ${request.user_id} - ${request.start_date} - ${request.end_date} - ${request.vacation_days} - ${request.vacation_type} - ${request.status} - ${request.reason} - ${request.manager_id}</p>`;
                    });

                } else {
                    // Handle login error
                    console.error(data.error);
                }
            } catch (error) {
                console.error('Error getting user information:', error);
            }
        });
    </script>
</body>

</html>